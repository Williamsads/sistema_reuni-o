{% extends "base.html" %}

{% block content %}
<div style="text-align: center; margin-bottom: 3rem;">
    <h1>Gerenciar Usuários</h1>
    <p class="subtitle">Controle de acesso ao sistema de agendamento.</p>
</div>

<div style="display: grid; grid-template-columns: 350px 1fr; gap: 3rem; align-items: start;">
    <!-- Formulário de Criação -->
    <div class="form-container" style="width: 100%; margin: 0; padding: 2rem;">
        <h3 style="margin-bottom: 2rem; color: var(--primary);">Novo Usuário</h3>
        <form action="{{ url_for('gerenciar_usuarios') }}" method="POST">
            <div class="form-group">
                <label class="form-label">Nome de Usuário</label>
                <input type="text" name="username" class="form-input" placeholder="Ex: joao.silva" required>
            </div>
            <div class="form-group">
                <label class="form-label">Senha</label>
                <input type="password" name="senha" class="form-input" placeholder="Senha segura" required>
            </div>
            <button type="submit" class="btn btn-primary" style="width: 100%;">Criar Usuário</button>
        </form>
    </div>

    <!-- Lista de Usuários -->
    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>USUÁRIO</th>
                    <th style="text-align: right;">AÇÕES</th>
                </tr>
            </thead>
            <tbody>
                {% for user in usuarios %}
                <tr>
                    <td>
                        <div style="display: flex; align-items: center; gap: 0.75rem;">
                            <div
                                style="width: 32px; height: 32px; background: #e2e8f0; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--primary); font-weight: bold;">
                                {{ user.username[0].upper() }}
                            </div>
                            <span style="font-weight: 600;">{{ user.username }}</span>
                            {% if user.id == current_user.id %}
                            <span class="badge badge-free"
                                style="padding: 0.2rem 0.6rem; font-size: 0.65rem;">VOCÊ</span>
                            {% endif %}
                        </div>
                    </td>
                    <td style="text-align: right;">
                        {% if usuarios|length > 1 and user.id != current_user.id %}
                        <a href="{{ url_for('excluir_usuario', id=user.id) }}" class="cancel-btn"
                            onclick="return confirm('Excluir este usuário permanentemente?')">
                            Remover
                        </a>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}